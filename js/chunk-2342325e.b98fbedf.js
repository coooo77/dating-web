(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2342325e"],{"2d3b":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search"},[n("Searchbar",{on:{"after-submit":e.handleAfterSubmit}}),e.state.isWrong?n("Alert",{attrs:{wrong:e.wrongInformation}}):e._e(),n("div",{staticClass:"container mt-5"},[n("div",{staticClass:"users row"},e._l(e.users,(function(t){return n("UserCard",{key:t.id,attrs:{user:t},on:{afterChangeLiked:e.afterChangeLiked,afterClickUser:e.afterClickUser}})})),1),e.state.isAllLoaded&&!e.state.isInitial?n("Alert",{attrs:{wrong:e.wrong.allLoad,showXBtn:e.wrong.allLoad.showXBtn}}):e._e()],1),e.state.isLoading?n("Spinner"):e._e(),n("Observer",{attrs:{isAllLoaded:e.state.isAllLoaded},on:{intersect:e.intersected}})],1)},a=[],i=(n("4de4"),n("caad"),n("a15b"),n("d81d"),n("a434"),n("b0c0"),n("d3b7"),n("07ac"),n("4d63"),n("ac1f"),n("25f0"),n("2532"),n("3ca3"),n("498a"),n("ddb0"),n("5530")),s=(n("96cf"),n("1da1")),o=n("3835"),c=n("2909"),l=(n("a4d3"),n("e01a"),n("d28b"),n("06c5"));function u(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(l["a"])(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(o)throw i}}}}var d=n("98ab"),f=n("2375"),m=n("4e6b"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-bar bg-secondary d-flex justify-content-center shadow"},[n("form",{staticClass:"form-inline",attrs:{id:"search-form"},on:{submit:function(t){return t.preventDefault(),e.handleSearch(t)}}},[n("div",{staticClass:"d-inline"},[n("span",[e._v("找")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.gender,expression:"gender"}],attrs:{name:"gender"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.gender=t.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"",selected:"",disabled:""}},[e._v("--性別--")]),e._l(e.genderOption,(function(t){return n("option",{key:t.id,domProps:{value:t.value}},[e._v(e._s(t.name))])}))],2),n("span",[e._v("年齡從")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.minAge,expression:"minAge"}],staticClass:"d-inline",attrs:{type:"number",max:"100",min:"18",name:"min-age",placeholder:"歲"},domProps:{value:e.minAge},on:{input:function(t){t.target.composing||(e.minAge=t.target.value)}}}),n("span",[e._v("到")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.maxAge,expression:"maxAge"}],staticClass:"d-inline",attrs:{type:"number",max:"80",min:"18",name:"max-age",placeholder:"歲"},domProps:{value:e.maxAge},on:{input:function(t){t.target.composing||(e.maxAge=t.target.value)}}})]),n("div",{staticClass:"d-inline"},[n("span",[e._v("地區")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.location,expression:"location"}],attrs:{type:"text",name:"location",placeholder:"居住區域"},domProps:{value:e.location},on:{input:function(t){t.target.composing||(e.location=t.target.value)}}}),e._m(0)])])])},h=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"search-icon ml-2"},[n("button",{staticClass:"search-icon-btn",attrs:{type:"submit"}},[n("i",{staticClass:"fas fa-search"})])])}],p={data:function(){return{genderOption:[{id:1,name:"男性",value:"male"},{id:2,name:"女性",value:"female"},{id:3,name:"無限制",value:""}],gender:"",minAge:18,maxAge:80,location:""}},methods:{handleSearch:function(e){var t=e.target,n=new FormData(t);this.$emit("after-submit",n)}}},v=p,b=(n("d1d5"),n("2877")),w=Object(b["a"])(v,g,h,!1,null,"4a475d5a",null),x=w.exports,y=n("2957"),A=n("4cce"),_=n("2708"),S=n("c968"),R={created:function(){this.state.isWrong=!0,this.wrongInformation=this.wrong.initialSearch,this.fetchAllUsers()},data:function(){return{searchResult:[],initialUsers:[],users:[],offset:12,state:{isWrong:!1,isLoading:!1,isAllLoaded:!1,isInitial:!0},wrong:{initialSearch:{strong:"請輸入設定！",text:"尋找理想的好友！"},wrongSearch:{strong:"發生錯誤",text:"請重新搜尋！"},noResult:{strong:"沒有任何符合的資料",text:"請重新搜尋！"},allLoad:{strong:"已經到頁底!",text:"所有使用者已經顯示完畢。",showXBtn:!1}},wrongInformation:{}}},components:{Searchbar:x,Alert:d["a"],Spinner:f["a"],Observer:m["a"],UserCard:y["a"]},methods:{handleAfterSubmit:function(e){this.state.isWrong=!1,this.state.isInitial=!1,this.state.isAllLoaded=!1;var t,n={},r=u(e.entries());try{for(r.s();!(t=r.n()).done;){var a=Object(o["a"])(t.value,2),i=a[0],s=a[1];n[i]=s}}catch(d){r.e(d)}finally{r.f()}if(n["min-age"]>n["max-age"])return this.state.isWrong=!0,this.state.isInitial=!0,this.wrongInformation=this.wrong.wrongSearch,void(this.users=[]);var l=this.filterUsers(this.initialUsers,n["min-age"],n["max-age"],n.gender,n.location);0===l.length?(this.state.isWrong=!0,this.wrongInformation=this.wrong.noResult):(this.searchResult=Object(c["a"])(l),this.users=this.searchResult.splice(0,this.offset),0===this.searchResult.length&&(this.state.isAllLoaded=!0))},fetchAllUsers:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.delegateYield(regeneratorRuntime.mark((function t(){var n,r,a,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=JSON.parse(sessionStorage.getItem("like"));case 1:if(0!==e.initialUsers.length){t.next=13;break}return t.next=4,A["a"].get120Users();case 4:if(r=t.sent,a=r.data,s=r.status,o=r.statusText,200===s){t.next=10;break}throw new Error(o);case 10:e.initialUsers=a.results.map((function(e,t){return Object(i["a"])(Object(i["a"])({},e),{},{id:t+1,name:Object.values(e.name).splice(1,2).join(" "),isLiked:n.includes(t+1)})})),t.next=1;break;case 13:case"end":return t.stop()}}),t)}))(),"t0",2);case 2:t.next=8;break;case 4:t.prev=4,t.t1=t["catch"](0),console.error(t.t1),S["a"].fire({icon:"error",title:"伺服器忙碌中，請稍後再試"});case 8:case"end":return t.stop()}}),t,null,[[0,4]])})))()},filterUsers:function(e,t,n,r,a){var i=e.filter((function(e){return e.dob.age<=n&&e.dob.age>=t}));return r&&(i=i.filter((function(e){return e.gender===r}))),a.trim()&&(i=i.filter((function(e){var t=new RegExp(a.trim(),"i");return t.test(e.location.city)}))),i},fetchMoreUser:function(){this.state.isLoading=!0;var e,t=this.searchResult.splice(0,this.offset);0===t.length?this.state.isAllLoaded=!0:(e=this.users).push.apply(e,Object(c["a"])(t));this.state.isLoading=!1},intersected:function(){this.fetchMoreUser()}},mixins:[_["b"],_["a"]]},k=R,C=Object(b["a"])(k,r,a,!1,null,null,null);t["default"]=C.exports},"498a":function(e,t,n){"use strict";var r=n("23e7"),a=n("58a8").trim,i=n("c8d2");r({target:"String",proto:!0,forced:i("trim")},{trim:function(){return a(this)}})},"4d63":function(e,t,n){var r=n("83ab"),a=n("da84"),i=n("94ca"),s=n("7156"),o=n("9bf2").f,c=n("241c").f,l=n("44e7"),u=n("ad6d"),d=n("9f7f"),f=n("6eeb"),m=n("d039"),g=n("69f3").set,h=n("2626"),p=n("b622"),v=p("match"),b=a.RegExp,w=b.prototype,x=/a/g,y=/a/g,A=new b(x)!==x,_=d.UNSUPPORTED_Y,S=r&&i("RegExp",!A||_||m((function(){return y[v]=!1,b(x)!=x||b(y)==y||"/a/i"!=b(x,"i")})));if(S){var R=function(e,t){var n,r=this instanceof R,a=l(e),i=void 0===t;if(!r&&a&&e.constructor===R&&i)return e;A?a&&!i&&(e=e.source):e instanceof R&&(i&&(t=u.call(e)),e=e.source),_&&(n=!!t&&t.indexOf("y")>-1,n&&(t=t.replace(/y/g,"")));var o=s(A?new b(e,t):b(e,t),r?this:w,R);return _&&n&&g(o,{sticky:n}),o},k=function(e){e in R||o(R,e,{configurable:!0,get:function(){return b[e]},set:function(t){b[e]=t}})},C=c(b),L=0;while(C.length>L)k(C[L++]);w.constructor=R,R.prototype=w,f(a,"RegExp",R)}h("RegExp")},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var r=n("1d80"),a=n("5899"),i="["+a+"]",s=RegExp("^"+i+i+"*"),o=RegExp(i+i+"*$"),c=function(e){return function(t){var n=String(r(t));return 1&e&&(n=n.replace(s,"")),2&e&&(n=n.replace(o,"")),n}};e.exports={start:c(1),end:c(2),trim:c(3)}},7156:function(e,t,n){var r=n("861d"),a=n("d2bb");e.exports=function(e,t,n){var i,s;return a&&"function"==typeof(i=t.constructor)&&i!==n&&r(s=i.prototype)&&s!==n.prototype&&a(e,s),e}},8116:function(e,t,n){},c8d2:function(e,t,n){var r=n("d039"),a=n("5899"),i="​᠎";e.exports=function(e){return r((function(){return!!a[e]()||i[e]()!=i||a[e].name!==e}))}},d1d5:function(e,t,n){"use strict";var r=n("8116"),a=n.n(r);a.a}}]);
//# sourceMappingURL=chunk-2342325e.b98fbedf.js.map